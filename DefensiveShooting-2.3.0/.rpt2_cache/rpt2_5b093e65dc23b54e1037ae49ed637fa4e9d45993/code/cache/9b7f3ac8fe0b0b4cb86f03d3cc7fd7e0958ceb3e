{
  "code": "import { lwg, EventAdmin, Tools } from \"../Lwg_Template/lwg\";\r\nimport { GEnum } from \"../Lwg_Template/Global\";\r\nexport default class UIMain_Bullet extends lwg.Admin.Object {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.reboundRotae = 0;\r\n        this.accelerated = 0;\r\n        this.speed = 0;\r\n    }\r\n    selfNode() {\r\n        this.EnemyParent = this.selfScene['EnemyParent'];\r\n        this.BarrierParent = this.selfScene['BarrierParent'];\r\n    }\r\n    lwgOnEnable() {\r\n        this.bulletState = GEnum.BulletState.attack;\r\n    }\r\n    attackEnemy() {\r\n        for (let index = 0; index < this.EnemyParent.numChildren; index++) {\r\n            const enemy = this.EnemyParent.getChildAt(index);\r\n            if (enemy) {\r\n                let len = lwg.Tools.twoObjectsLen_2D(this.self, enemy);\r\n                if (len < 50) {\r\n                    let num = enemy.getChildByName('Num');\r\n                    if (enemy['UIMain_Enemy'].enemyType === this.bulletColor) {\r\n                        if (this.bulletState === GEnum.BulletState.attack) {\r\n                            num.text = (Number(num.text) - 2).toString();\r\n                            if (Number(num.text) <= 0) {\r\n                                enemy.removeSelf();\r\n                            }\r\n                            this.self.removeSelf();\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.bulletState = GEnum.BulletState.rebound;\r\n                        this.accelerated = 0;\r\n                        this.reboundRotae = Math.floor(Math.random() * 2) === 1 ? Math.random() * this.speed / 3 + 10 : -Math.random() * this.speed / 3 + 10;\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    attackSpecialObj() {\r\n        if (this.BarrierParent) {\r\n            for (let index = 0; index < this.BarrierParent.numChildren; index++) {\r\n                const specialObj = this.BarrierParent.getChildAt(index);\r\n                ;\r\n                if (specialObj) {\r\n                    let len = lwg.Tools.twoObjectsLen_2D(this.self, specialObj);\r\n                    if (len < 50) {\r\n                        switch (specialObj.name) {\r\n                            case GEnum.SpecialObj.stone:\r\n                                this.attackStone(specialObj);\r\n                                break;\r\n                            case GEnum.SpecialObj.commonSplit:\r\n                                this.attackSplit(specialObj);\r\n                                break;\r\n                            default:\r\n                                break;\r\n                        }\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    attackStone(stone) {\r\n        let Num = stone.getChildByName('Num');\r\n        Num.text = (Number(Num.text) - 1).toString();\r\n        if (Num.text <= '0') {\r\n            stone.removeSelf();\r\n            this.self.removeSelf();\r\n        }\r\n        this.bulletState = GEnum.BulletState.rebound;\r\n        this.accelerated = 0;\r\n        this.reboundRotae = Math.floor(Math.random() * 2) === 1 ? Math.random() * this.speed / 3 + 10 : -Math.random() * this.speed / 3 + 10;\r\n    }\r\n    attackSplit(split) {\r\n        if (this.whoFired !== GEnum.BulletWhoFired.split) {\r\n            let Num = split.getChildByName('Num');\r\n            Num.text = (Number(Num.text) - 1).toString();\r\n            if (Num.text <= '0') {\r\n                split.removeSelf();\r\n            }\r\n            this.self.removeSelf();\r\n            for (let index = 0; index < 4; index++) {\r\n                EventAdmin.EventClass.notify(GEnum.EventType.createBullet, [GEnum.BulletWhoFired.split, this.bulletColor, null, split.x, split.y, Tools.angle_Vector(90 * index + 45), 40]);\r\n            }\r\n        }\r\n    }\r\n    lwgOnUpdate() {\r\n        if (this.bulletState === GEnum.BulletState.attack) {\r\n            this.attackEnemy();\r\n            this.attackSpecialObj();\r\n            if (this.accelerated >= this.speed) {\r\n                this.accelerated = 0;\r\n                return;\r\n            }\r\n            else {\r\n                if (this.speed + this.accelerated <= 10) {\r\n                }\r\n                else {\r\n                    this.accelerated -= 2;\r\n                }\r\n            }\r\n            this.self.x -= (this.speed + this.accelerated) * this.movePoint.x;\r\n            this.self.y -= (this.speed + this.accelerated) * this.movePoint.y;\r\n            if (this.self.y < -100 || this.self.y > Laya.stage.height || this.self.x > Laya.stage.width || this.self.x < 0) {\r\n                this.self.removeSelf();\r\n            }\r\n        }\r\n        else if (this.bulletState === GEnum.BulletState.rebound) {\r\n            if (this.speed / 2 + this.accelerated <= 0) {\r\n                this.self.alpha -= 0.05;\r\n                if (this.self.alpha <= 0) {\r\n                    this.self.removeSelf();\r\n                }\r\n            }\r\n            else {\r\n                this.self.rotation += this.reboundRotae;\r\n                this.accelerated -= 2;\r\n                this.self.x += (this.speed / 2 + this.accelerated) * this.movePoint.x;\r\n                this.self.y += (this.speed / 2 + this.accelerated) * this.movePoint.y;\r\n            }\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "F:/Work/Game/05_DefensiveShooting_2.3.0/project/DefensiveShooting-2.3.0/src/script/Lwg_Template/lwg.ts",
    "F:/Work/Game/05_DefensiveShooting_2.3.0/project/DefensiveShooting-2.3.0/src/script/Lwg_Template/Global.ts"
  ]
}
